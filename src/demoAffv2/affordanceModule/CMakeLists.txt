SET(KEYWORD "demoAffv2")

PROJECT(${KEYWORD})

FIND_PACKAGE(ICUB)
FIND_PACKAGE(YARP REQUIRED)
FIND_PACKAGE(GSL REQUIRED)
FIND_PACKAGE(ATTENTIONSELECTIONLIB REQUIRED)
FIND_PACKAGE(AFFACTIONPRIMITIVES REQUIRED)
FIND_PACKAGE(LIBEYECUB REQUIRED)
FIND_PACKAGE(PNL)
FIND_PACKAGE(CTRLLIB)

message(STATUS "${PNL_LIBRARIES} ${PNL_INCLUDE_DIRS}")
message(STATUS "${OPENCV_LIBRARIES} ${OPENCV_INCLUDE_DIR} ${OPENCV_INCLUDE_DIRS}")

INCLUDE_DIRECTORIES(
  ${PROJECT_SOURCE_DIR}/include
  ${ATTENTIONSELECTIONLIB_INCLUDE_DIRS}
  )

INCLUDE_DIRECTORIES(${PNL_INCLUDE_DIRS})
INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR})
INCLUDE_DIRECTORIES(${ICUB_DIR}/src/kinematics/include)
INCLUDE_DIRECTORIES(${GSL_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${AFFACTIONPRIMITIVES_INCLUDE_DIRS})
INCLUDE_DIRECTORIES(${LIBVISLAB_INCLUDE_DIRS})
INCLUDE_DIRECTORIES(${LIBEYECUB_INCLUDE_DIRS})
# For PNL compatibility we need to use an old opencx that comes with pnl
INCLUDE_DIRECTORIES("/usr/local/include/opencx/")
INCLUDE_DIRECTORIES(${CTRLLIB_INCLUDE_DIRS})

IF(USE_ICUB_MOD)
  ADD_DEFINITIONS(-DUSE_ICUB_MOD)
  FIND_PACKAGE(icubmod)
  IMPORT_DEVICES(${ICUB_DIR}/src/demoAffv2/affordanceModule/src/drivers.h icubmod)
  SET(folder_header drivers.h)
ELSE(USE_ICUB_MOD)
  SET(folder_header)
ENDIF(USE_ICUB_MOD)

# Search for source code.
FILE(GLOB folder_source 
  src/*.cpp
  )
FILE(GLOB folder_header 
	include/iCub/*.h
	)
      SOURCE_GROUP("Source Files" FILES ${folder_source})
      SOURCE_GROUP("Header Files" FILES ${folder_header})
      
      # Set up our main executable.
      IF (folder_source)
	ADD_EXECUTABLE(${KEYWORD} 
	  ${folder_source} 
	  ${folder_header}
	  )
      ELSE (folder_source)
	MESSAGE(FATAL_ERROR "No source code files found. Please add something")
      ENDIF (folder_source)
TARGET_LINK_LIBRARIES(${KEYWORD} 
  ${ATTENTIONSELECTIONLIB_LIBRARIES} ${LIBEYECUB_LIBRARIES} ${LIBVISLAB_LIBRARIES} ${PNL_LIBRARIES} ${AFFACTIONPRIMITIVES_LIBRARIES} ${CTRLLIB_LIBRARIES} )
#/usr/local/lib/libpnl.so  /usr/local/lib/libpnlcxcore.a

INSTALL_TARGETS(/bin ${KEYWORD})
